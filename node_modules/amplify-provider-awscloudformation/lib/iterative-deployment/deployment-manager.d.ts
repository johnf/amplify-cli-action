import { $TSContext, IDeploymentStateManager } from 'amplify-cli-core';
import { DeploymentMachineOp, StateMachineError } from './state-machine';
import { IStackProgressPrinter } from './stack-event-monitor';
import ora from 'ora';
interface DeploymentManagerOptions {
    throttleDelay?: number;
    eventPollingDelay?: number;
    userAgent?: string;
}
export declare class DeploymentError extends Error {
    constructor(errors: StateMachineError[]);
}
export declare type DeploymentOp = Omit<DeploymentMachineOp, 'region' | 'stackTemplatePath' | 'stackTemplateUrl'> & {
    stackTemplatePathOrUrl: string;
};
export declare type DeploymentStep = {
    deployment: DeploymentOp;
    rollback: DeploymentOp;
};
export declare class DeploymentManager {
    private region;
    private deploymentBucket;
    private spinner;
    private printer;
    static createInstance: (context: $TSContext, deploymentBucket: string, spinner: ora.Ora, options?: DeploymentManagerOptions, printer?: IStackProgressPrinter) => Promise<DeploymentManager>;
    private deployment;
    private options;
    private cfnClient;
    private s3Client;
    private ddbClient;
    private deploymentStateManager?;
    private logger;
    private constructor();
    deploy: (deploymentStateManager: IDeploymentStateManager) => Promise<void>;
    rollback: (deploymentStateManager: IDeploymentStateManager) => Promise<void>;
    addStep: (deploymentStep: DeploymentStep) => void;
    addRollbackStep: (rollbackStep: DeploymentOp) => void;
    setPrinter: (printer: IStackProgressPrinter) => void;
    private startRollBackFn;
    private ensureStack;
    private ensureTemplateExists;
    private getTableStatus;
    private waitForActiveTables;
    private waitForIndices;
    private preRollbackTableCheck;
    private stackPollFn;
    private doDeploy;
    private waitForDeployment;
    private rollBackStack;
    private logSpinnerMessage;
}
export {};
//# sourceMappingURL=deployment-manager.d.ts.map